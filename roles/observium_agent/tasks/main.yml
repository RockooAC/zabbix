---
- name: Copy observium_agent to /usr/bin/
  ansible.builtin.copy:
    src: observium_agent
    dest: /usr/bin/observium_agent
    mode: '0755'

- name: Create /usr/lib/observium_agent directory
  ansible.builtin.file:
    path: /usr/lib/observium_agent
    state: directory
    mode: '0755'

- name: Create /usr/lib/observium_agent/scripts-available directory
  ansible.builtin.file:
    path: /usr/lib/observium_agent/scripts-available
    state: directory
    mode: '0755'

- name: Create /usr/lib/observium_agent/scripts-enabled directory
  ansible.builtin.file:
    path: /usr/lib/observium_agent/scripts-enabled
    state: directory
    mode: '0755'

- name: Check if bundled scripts directory exists
  ansible.builtin.stat:
    path: "{{ role_path }}/files/scripts"
  register: observium_agent_scripts_dir

- name: Copy scripts to /usr/lib/observium_agent/scripts-available/
  ansible.builtin.copy:
    src: scripts/
    dest: /usr/lib/observium_agent/scripts-available/
    mode: '0755'
  when: observium_agent_scripts_dir.stat.exists
